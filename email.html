<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 15. Email</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Lubuntu Setup" /><link rel="up" href="index.html" title="Lubuntu Setup" /><link rel="prev" href="upgrading_to_a_new_release.html" title="14.3. Upgrading to a new release" /><link rel="next" href="procmail.html" title="15.2. Procmail" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 15. Email</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="upgrading_to_a_new_release.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="procmail.html">Next</a></td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="email"></a>Chapter 15. Email</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="email.html#fetchmail">15.1. Fetchmail</a></span></dt><dt><span class="section"><a href="procmail.html">15.2. Procmail</a></span></dt><dt><span class="section"><a href="msmtp.html">15.3. msmtp</a></span></dt><dt><span class="section"><a href="mutt.html">15.4. Mutt</a></span></dt></dl></div><p>We will pull the email from Google. Google supports both IMAP and POP3
client access, not that it matters to Google which one we will use.
Even if we use POP3, Google will keep the messages on the server
anyway. But we will use POP3 on the client.</p><p>Before we proceed any further, you need to enable POP3 access in your
Google account. You need to do the following</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Login to your Google account</li><li class="listitem">Go to Settings</li><li class="listitem">Find the <span class="emphasis"><em>"Forwarding and POP/IMAP"</em></span></li><li class="listitem">Choose <span class="emphasis"><em>Enable POP for all mail</em></span></li><li class="listitem">Save the changes</li></ol></div><p>Now, we can proceed to setting up the client part. We need to get a
couple of things.</p><div class="example"><a id="idm140124708156640"></a><p class="title"><strong>Example 15.1. Things we need</strong></p><div class="example-contents"><pre class="literallayout">sudo apt-get install fetchmail <a id="CO2-1"></a><span><img src="images/callouts/1.png" alt="1" border="0" /></span>
sudo apt-get install procmail <a id="CO2-2"></a><span><img src="images/callouts/2.png" alt="2" border="0" /></span>
sudo apt-get install msmtp <a id="CO2-3"></a><span><img src="images/callouts/3.png" alt="3" border="0" /></span>
sudo apt-get install mutt <a id="CO2-4"></a><span><img src="images/callouts/4.png" alt="4" border="0" /></span>
sudo apt-get install w3m <a id="CO2-5"></a><span><img src="images/callouts/5.png" alt="5" border="0" /></span></pre></div></div><br class="example-break" /><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-1"><span><img src="images/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>This will pull mail from Gmail or any other mail server. We can pull mail from more
than one account, but we’ll pull from just one for now</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-2"><span><img src="images/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>This can filter your emails, so you can put mails in different
folders if you so wish to organize them</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-3"><span><img src="images/callouts/3.png" alt="3" border="0" /></span></a> </p></td><td valign="top" align="left"><p>This allows us to compose email and send them using GMails SMTP</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-4"><span><img src="images/callouts/4.png" alt="4" border="0" /></span></a> </p></td><td valign="top" align="left"><p>This is an email client, this is the part we interact with. We
could simply use the built-in <span class="strong"><strong>mail</strong></span> command that is present in most
*NIX, but that is not user-friendly. There are other choices for email
clients like PINE, but mutt is what I’m used to</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO2-5"><span><img src="images/callouts/5.png" alt="5" border="0" /></span></a> </p></td><td valign="top" align="left"><p>A text-based web browser</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="fetchmail"></a>15.1. Fetchmail</h2></div></div></div><div class="example"><a id="idm140124708144256"></a><p class="title"><strong>Example 15.2. Checking if fetchmail has SSL support</strong></p><div class="example-contents"><pre class="screen">$ ldd `which fetchmail` | grep libssl
    libssl.so.1.0.0 =&gt; /lib/x86_64-linux-gnu/libssl.so.1.0.0 (0x00007fbd7e706000)</pre></div></div><br class="example-break" /><p>You should see something like the one in line #2 of the listing
above.</p><p>The next thing to check is we have the <span class="emphasis"><em>ca-certificates</em></span> installed on
our system. This is necessary to pull mails from Google servers. Most
modern Linux systems already have this installed.
If it isn’t, you can always install it with the command <code class="literal">sudo apt-get install
ca-certificates</code>. An easy way to check if you already have
ca-certificates is to run the following command.</p><div class="example"><a id="idm140124708140784"></a><p class="title"><strong>Example 15.3. Check for ca-certificates</strong></p><div class="example-contents"><pre class="literallayout">$ dpkg -l | grep ca-certificates
	ii ca-certificates
	all Common CA certificates	2016010ubuntu
	...  ...
	...  ...</pre></div></div><br class="example-break" /><p>If you saw an output similar to line 2 of the listing above, then you
already have the ca-certificates. It should actually come with your
installation. But if you don’t have it, just get it via <code class="literal">sudo apt-get
install ca-certificates</code>.</p><p>Now we can check if our fetchmail and certificates can successfully
talk to Google servers</p><div class="example"><a id="idm140124708137504"></a><p class="title"><strong>Example 15.4. Checking if fetchmail+certificates can talk to Google Servers</strong></p><div class="example-contents"><pre class="screen">$ openssl s_client -connect pop.gmail.com:995
...  ...
...  ...
...  ...
+OK Gpop ready for request from &lt;your IP address&gt; ...</pre></div></div><br class="example-break" /><p>That last command above will actually spew a lot more info but we’re
only interested in the that last message that said "+OK Gpop ready..".
That meant our certificates and fetchmail are working as expected. Now
we can start configuring the fetchmailrc file. You will need to create
it first with the command <code class="literal">touch ~/.fetchmailrc</code>. The listing below
shows a basic fetchmailrc.</p><div class="example"><a id="idm140124708134448"></a><p class="title"><strong>Example 15.5. Fetchmail Configuration</strong></p><div class="example-contents"><pre class="screen">set postmaster 'ted' <a id="CO3-1"></a><span><img src="images/callouts/1.png" alt="1" border="0" /></span>
set daemon 600 <a id="CO3-2"></a><span><img src="images/callouts/2.png" alt="2" border="0" /></span>

poll "pop.gmail.com" with proto POP3 <a id="CO3-3"></a><span><img src="images/callouts/3.png" alt="3" border="0" /></span>
  user 'youremail@gmail.com' there with password 'yourpassword' <a id="CO3-4"></a><span><img src="images/callouts/4.png" alt="4" border="0" /></span> <a id="CO3-5"></a><span><img src="images/callouts/5.png" alt="5" border="0" /></span>
  is ted here options ssl keep <a id="CO3-6"></a><span><img src="images/callouts/6.png" alt="6" border="0" /></span> <a id="CO3-7"></a><span><img src="images/callouts/7.png" alt="7" border="0" /></span>
  mda '/usr/bin/procmail -d %T' <a id="CO3-8"></a><span><img src="images/callouts/8.png" alt="8" border="0" /></span></pre></div></div><br class="example-break" /><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-1"><span><img src="images/callouts/1.png" alt="1" border="0" /></span></a> </p></td><td valign="top" align="left"><p>If for some reason, that fetchmail cannot deliver the email to the
right inbox, we will send the mail to the spool file
<span class="emphasis"><em>/var/mail/ted</em></span>. If I omitted this line, whatever undelivered
email will be placed in <span class="emphasis"><em>/var/mail/postmaster</em></span></p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-2"><span><img src="images/callouts/2.png" alt="2" border="0" /></span></a> </p></td><td valign="top" align="left"><p>We are <span class="emphasis"><em>daemonizing</em></span> the <code class="literal">fetchmail</code> program. We want it to run
every 600 seconds. You can set it to to 300 seconds if you wish, but
Google may penalize you for hitting the server that often. Do you
really want to check your email every 10 minutes anyway? If you
comment out this line, fetchmail won’t run in the background. That
means, you have to invoke it everytime you want to check for new email</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-3"><span><img src="images/callouts/3.png" alt="3" border="0" /></span></a> </p></td><td valign="top" align="left"><p>We will check for <span class="emphasis"><em>pop.gmail.com</em></span> for emails that we haven’t
downloaded yet using the POP3 protocol</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-4"><span><img src="images/callouts/4.png" alt="4" border="0" /></span></a> </p></td><td valign="top" align="left"><p>substitute your actual GMail address with to
<span class="emphasis"><em>youremail@gmail.com</em></span></p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-5"><span><img src="images/callouts/5.png" alt="5" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Substitute your actual GMail account password
to <span class="emphasis"><em>yourpassword</em></span></p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-6"><span><img src="images/callouts/6.png" alt="6" border="0" /></span></a> </p></td><td valign="top" align="left"><p><code class="literal">is</code> <span class="strong"><strong>ted</strong></span> <code class="literal">here</code> means I am mapping the user named <code class="literal">ted</code> (in my
Linux machine) to <code class="literal">youremail@gmail.com there</code>, who happens to be the
remote user</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-7"><span><img src="images/callouts/7.png" alt="7" border="0" /></span></a> </p></td><td valign="top" align="left"><p><code class="literal">options ssl keep</code>. We’ll use SSL to encrypt our communications,
and we telling Google not to delete the emails on the server even
after we have downloaded it</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO3-8"><span><img src="images/callouts/8.png" alt="8" border="0" /></span></a> </p></td><td valign="top" align="left"><p>Finally, whatever emails we pull from the servers, we will pass
them to <code class="literal">procmail</code> for filtering and further processing</p></td></tr></table></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="upgrading_to_a_new_release.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="procmail.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">14.3. Upgrading to a new release </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 15.2. Procmail</td></tr></table></div></body></html>